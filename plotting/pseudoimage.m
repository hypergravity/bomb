function pseudoimage(x,y,c,m,clim,cmod)
dx=x(2)-x(1);
dy=y(2)-y(1);
%color
if strcmp(cmod,'jet')==1
c0=[0,0,0.562500000000000;0,0,0.625000000000000;0,0,0.687500000000000;
    0,0,0.750000000000000;0,0,0.812500000000000;0,0,0.875000000000000;
    0,0,0.937500000000000;0,0,1;0,0.0625000000000000,1;0,0.125000000000000,1;
    0,0.187500000000000,1;0,0.250000000000000,1;0,0.312500000000000,1;
    0,0.375000000000000,1;0,0.437500000000000,1;0,0.500000000000000,1;
    0,0.562500000000000,1;0,0.625000000000000,1;0,0.687500000000000,1;
    0,0.750000000000000,1;0,0.812500000000000,1;0,0.875000000000000,1;
    0,0.937500000000000,1;0,1,1;0.0625000000000000,1,0.937500000000000;
    0.125000000000000,1,0.875000000000000;0.187500000000000,1,0.812500000000000;
    0.250000000000000,1,0.750000000000000;0.312500000000000,1,0.687500000000000;
    0.375000000000000,1,0.625000000000000;0.437500000000000,1,0.562500000000000;
    0.500000000000000,1,0.500000000000000;0.562500000000000,1,0.437500000000000;
    0.625000000000000,1,0.375000000000000;0.687500000000000,1,0.312500000000000;
    0.750000000000000,1,0.250000000000000;0.812500000000000,1,0.187500000000000;
    0.875000000000000,1,0.125000000000000;0.937500000000000,1,0.0625000000000000;
    1,1,0;1,0.937500000000000,0;1,0.875000000000000,0;1,0.812500000000000,0;
    1,0.750000000000000,0;1,0.687500000000000,0;1,0.625000000000000,0;
    1,0.562500000000000,0;1,0.500000000000000,0;1,0.437500000000000,0;
    1,0.375000000000000,0;1,0.312500000000000,0;1,0.250000000000000,0;
    1,0.187500000000000,0;1,0.125000000000000,0;1,0.0625000000000000,0;
    1,0,0;0.937500000000000,0,0;0.875000000000000,0,0;0.812500000000000,0,0;
    0.750000000000000,0,0;0.687500000000000,0,0;0.625000000000000,0,0;
    0.562500000000000,0,0;0.500000000000000,0,0;];
elseif strcmp(cmod,'hot')==1
    c0=[0.0416666666666667,0,0;0.0833333333333333,0,0;
        0.125000000000000,0,0;0.166666666666667,0,0;
        0.208333333333333,0,0;0.250000000000000,0,0;
        0.291666666666667,0,0;0.333333333333333,0,0;
        0.375000000000000,0,0;0.416666666666667,0,0;
        0.458333333333333,0,0;0.500000000000000,0,0;
        0.541666666666667,0,0;0.583333333333333,0,0;
        0.625000000000000,0,0;0.666666666666667,0,0;
        0.708333333333333,0,0;0.750000000000000,0,0;
        0.791666666666667,0,0;0.833333333333333,0,0;
        0.875000000000000,0,0;0.916666666666667,0,0;
        0.958333333333333,0,0;1,0,0;1,0.0416666666666667,0;
        1,0.0833333333333333,0;1,0.125000000000000,0;
        1,0.166666666666667,0;1,0.208333333333333,0;
        1,0.250000000000000,0;1,0.291666666666667,0;
        1,0.333333333333333,0;1,0.375000000000000,0;
        1,0.416666666666667,0;1,0.458333333333333,0;
        1,0.500000000000000,0;1,0.541666666666667,0;
        1,0.583333333333333,0;1,0.625000000000000,0;
        1,0.666666666666667,0;1,0.708333333333333,0;
        1,0.750000000000000,0;1,0.791666666666667,0;
        1,0.833333333333333,0;1,0.875000000000000,0;
        1,0.916666666666667,0;1,0.958333333333333,0;
        1,1,0;1,1,0.0625000000000000;1,1,0.125000000000000;
        1,1,0.187500000000000;1,1,0.250000000000000;
        1,1,0.312500000000000;1,1,0.375000000000000;
        1,1,0.437500000000000;1,1,0.500000000000000;
        1,1,0.562500000000000;1,1,0.625000000000000;
        1,1,0.687500000000000;1,1,0.750000000000000;
        1,1,0.812500000000000;1,1,0.875000000000000;
        1,1,0.937500000000000;1,1,1;];
elseif strcmp(cmod,'revhot')==1
    c0=[0.0416666666666667,0,0;0.0833333333333333,0,0;
        0.125000000000000,0,0;0.166666666666667,0,0;
        0.208333333333333,0,0;0.250000000000000,0,0;
        0.291666666666667,0,0;0.333333333333333,0,0;
        0.375000000000000,0,0;0.416666666666667,0,0;
        0.458333333333333,0,0;0.500000000000000,0,0;
        0.541666666666667,0,0;0.583333333333333,0,0;
        0.625000000000000,0,0;0.666666666666667,0,0;
        0.708333333333333,0,0;0.750000000000000,0,0;
        0.791666666666667,0,0;0.833333333333333,0,0;
        0.875000000000000,0,0;0.916666666666667,0,0;
        0.958333333333333,0,0;1,0,0;1,0.0416666666666667,0;
        1,0.0833333333333333,0;1,0.125000000000000,0;
        1,0.166666666666667,0;1,0.208333333333333,0;
        1,0.250000000000000,0;1,0.291666666666667,0;
        1,0.333333333333333,0;1,0.375000000000000,0;
        1,0.416666666666667,0;1,0.458333333333333,0;
        1,0.500000000000000,0;1,0.541666666666667,0;
        1,0.583333333333333,0;1,0.625000000000000,0;
        1,0.666666666666667,0;1,0.708333333333333,0;
        1,0.750000000000000,0;1,0.791666666666667,0;
        1,0.833333333333333,0;1,0.875000000000000,0;
        1,0.916666666666667,0;1,0.958333333333333,0;
        1,1,0;1,1,0.0625000000000000;1,1,0.125000000000000;
        1,1,0.187500000000000;1,1,0.250000000000000;
        1,1,0.312500000000000;1,1,0.375000000000000;
        1,1,0.437500000000000;1,1,0.500000000000000;
        1,1,0.562500000000000;1,1,0.625000000000000;
        1,1,0.687500000000000;1,1,0.750000000000000;
        1,1,0.812500000000000;1,1,0.875000000000000;
        1,1,0.937500000000000;1,1,1;];
    c0=flipud(c0);
elseif strcmp(cmod,'gray')==1
    %c0=repmat((-1:-0.02:0),3,1)';
    c0=repmat((0:0.02:1),3,1)';
elseif strcmp(cmod,'revgray')==1
    %c0=repmat((-1:-0.02:0),3,1)';
    c0=repmat((1:-0.02:0),3,1)';
end
c(c<clim(1))=clim(1);
c(c>clim(2))=clim(2);
c=ceil((c-clim(1))./(clim(2)-clim(1))*length(c0));

x=[x(1)-(x(2)-x(1)),x,x(end)+x(end)-x(end-1)];
y=[y(1)-(y(2)-y(1)),y,y(end)+y(end)-y(end-1)];

x1=(x(2:end)+x(1:end-1))/2;
y1=(y(2:end)+y(1:end-1))/2;

%draw
%h=hggroup;
for i=1:length(x1)-1
    for j=1:length(y1)-1
        if m(j,i)>0
            a=[x1(i),x1(i),x1(i+1),x1(i+1),x1(i)];
            b=[y1(j),y1(j+1),y1(j+1),y1(j),y1(j)];
            if c(j,i)<=0 || isnan(c(j,i))
                c(j,i)=1;
            end
            f=fill(a,b,c0(c(j,i),:));
            set(f,'LineStyle','none');
            %set(f,'HitTest','off','Parent',h);
            hold on;
        end
    end
end
%set(h,'Visible','on');
end